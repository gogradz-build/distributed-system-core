import{Q as C,d as M,r as o,f as R,n as U,e as B,o as m,l as I,h as O,a as e,t as d,w as V,b as u,v,m as N,c as E,j,F,q as Q}from"./app-DuMmWb0e.js";import{_ as H}from"./AdminLayout-CuGKItQZ.js";import{$ as L}from"./dataTables.bootstrap4.min-Db9EHKM2.js";import"./Delta-BMm4mRWE.js";/* empty css                       */import"./AdminFooter-i6V7ulTS.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Y={class:"row mb-2"},$={class:"col-sm-6"},X={class:"breadcrumb float-sm-right mt-2"},z={class:"breadcrumb-item"},G=["href"],J={class:"breadcrumb-item active"},K=["href"],W={class:"row mt-4"},Z={class:"col-12"},ee={class:"card card-primary"},te={class:"card-header card-header-background"},se={class:"card-title"},ae={class:"card-body"},oe={class:"row"},le={class:"col-6"},de={class:"form-group"},re={class:"col-6"},ie={class:"form-group"},ne={class:"row"},ue={class:"col-6"},ce={class:"form-group"},me={class:"col-6"},ve={class:"form-group"},he={class:"row mt-4"},pe={class:"col-12"},fe={class:"card card-primary"},_e={class:"card-body"},be={id:"perchesTable",class:"table table-hover"},ye={class:"row d-flex"},ge={class:"input-group quantity-group"},Te={__name:"PurchasePayment",props:{purchase:{type:Object,default:()=>({})}},setup(k){var b,y,g,P,w,q,S;C();const n=M(),c=o(null);o(0),o("");const l=k,h=o((((b=l.purchase)==null?void 0:b.products)??[]).map(a=>({purchase_item_id:a.id,id:a.product_id,name:a.name,code:a.code,cost:a.cost,quantity:a.quantity,discount:a.discount,discounted_price:a.discounted_price||0,subtotal:a.subtotal,oldQuantity:a.oldQuantity}))),r=o({amount:"",order_status:((y=l.purchase)==null?void 0:y.order_status)||null});o(((g=l.purchase)==null?void 0:g.supplier_id)||null),o(((P=l.purchase)==null?void 0:P.warehouse_id)||null),o(((w=l.purchase)==null?void 0:w.payment_status)||null);const p=o(((q=l.purchase)==null?void 0:q.received_amount)||null);o(((S=l.purchase)==null?void 0:S.purchase_code)||null),R(()=>{const a=document.getElementById("cheque_form");a&&(a.style.display="none");const t=document.getElementById("dateInput"),s=new Date().toISOString().split("T")[0];t.value=s,U(()=>{L("#perchesTable").DataTable({responsive:!0,scrollX:!0,scrollY:"",scrollCollapse:!0,paging:!0})})});const T=a=>{if(a.preventDefault(),!c.value.checkValidity()){c.value.classList.add("was-validated");return}Q.put(route("purchase.payment.products",{id:l.purchase.id}),r.value).then(t=>{var s,i;(s=t==null?void 0:t.data)!=null&&s.message?(localStorage.setItem("successMessage",t.data.message),window.location.href=route("admin.payment.purchase")):(i=t==null?void 0:t.data)!=null&&i.error&&n.error(t.data.error)}).catch(t=>{var s,i,D,x;(i=(s=t.response)==null?void 0:s.data)!=null&&i.errors?Object.values(t.response.data.errors||{}).flat().forEach(A=>{n.error(A)}):(x=(D=t.response)==null?void 0:D.data)!=null&&x.message?n.error(t.response.data.message):n.error("An unexpected error occurred."),console.error(t)})},f=a=>{const t=a.discount??0,s=a.cost*t/100;return a.cost-s},_=B(()=>h.value.reduce((a,t)=>{const s=f(t);return a+s*t.quantity},0));return(a,t)=>(m(),I(H,null,{default:O(()=>[e("div",Y,[t[5]||(t[5]=e("div",{class:"col-sm-6"},[e("h4",{class:"mt-2"},"UPDATE PURCHASE PAYMENT")],-1)),e("div",$,[e("ol",X,[e("li",z,[e("a",{href:a.route("admin.dashboard")},"Home",8,G)]),e("li",J,[e("a",{href:a.route("admin.payment.purchase")},"Purchase Payment",8,K)]),t[4]||(t[4]=e("li",{class:"breadcrumb-item active"},"Update Purchase Payment",-1))])])]),e("div",W,[e("div",Z,[e("div",ee,[e("div",te,[e("h3",se," Purchase Code : "+d(l.purchase.purchase_code),1)]),e("div",ae,[e("form",{class:"needs-validation",ref_key:"formRef",ref:c,onSubmit:V(T,["prevent"]),novalidate:""},[e("div",oe,[e("div",le,[e("div",de,[t[6]||(t[6]=e("label",{for:"cheque-name"},"Total Price :",-1)),u(e("input",{type:"text",class:"form-control",id:"name",placeholder:"Enter Cheque Name","onUpdate:modelValue":t[0]||(t[0]=s=>_.value=s),disabled:""},null,512),[[v,_.value]])])]),e("div",re,[e("div",ie,[t[7]||(t[7]=e("label",{for:"cheque-name"},"Received Amount :",-1)),u(e("input",{type:"text",class:"form-control",id:"name",placeholder:"Enter Cheque Name","onUpdate:modelValue":t[1]||(t[1]=s=>p.value=s),disabled:""},null,512),[[v,p.value]])])])]),e("div",ne,[e("div",ue,[e("div",ce,[t[9]||(t[9]=e("label",{for:"name"},"Order Status :",-1)),u(e("select",{class:"form-select","aria-label":"Default select example","onUpdate:modelValue":t[2]||(t[2]=s=>r.value.order_status=s),required:""},t[8]||(t[8]=[e("option",{value:"",disabled:""},"Select Order Status",-1),e("option",{value:"1"},"Pending",-1),e("option",{value:"2"},"Confirmed",-1),e("option",{value:"3"},"Delivered",-1)]),512),[[N,r.value.order_status]]),t[10]||(t[10]=e("div",{class:"invalid-feedback"}," Please Provide Select Order Status ",-1))])]),e("div",me,[e("div",ve,[t[11]||(t[11]=e("label",{for:"cheque-name"},"Paid Amount :",-1)),u(e("input",{type:"number",class:"form-control",id:"name",placeholder:"Enter Paid Amount","onUpdate:modelValue":t[3]||(t[3]=s=>r.value.amount=s),required:""},null,512),[[v,r.value.amount]]),t[12]||(t[12]=e("div",{class:"invalid-feedback"}," Please Provide Enter Paid Amount ",-1))])])]),t[13]||(t[13]=e("div",{class:"col-lg-12 d-flex justify-content-end"},[e("button",{type:"submit ",class:"btn btn-primary mt-4 category-btn"},"Save")],-1))],544)])])])]),e("div",he,[e("div",pe,[e("div",fe,[t[15]||(t[15]=e("div",{class:"card-header card-header-background"},[e("h3",{class:"card-title"},"Purchase Payment Details")],-1)),e("div",_e,[e("table",be,[t[14]||(t[14]=e("thead",null,[e("tr",null,[e("th",{style:{width:"8%"}},"Product Code"),e("th",{style:{width:"20%"}},"Product Name"),e("th",null,"Cost (Rs.)"),e("th",null,"Discount (%)"),e("th",null,"Discount (Rs.)"),e("th",{style:{width:"15%"}},"Quantity"),e("th",null,"Subtotal (Rs)")])],-1)),e("tbody",null,[(m(!0),E(F,null,j(h.value,s=>(m(),E("tr",{key:s.id},[e("td",null,d(s.code),1),e("td",null,d(s.name),1),e("td",null,d(s.cost),1),e("td",null,d(s.discount),1),e("td",null,d((s.discount/100*(s.quantity*s.cost)).toFixed(2)),1),e("td",null,[e("div",ye,[e("div",ge,d(s.quantity),1)])]),e("td",null,d((f(s)*s.quantity).toFixed(2)),1)]))),128))])])])])])])]),_:1}))}};export{Te as default};
