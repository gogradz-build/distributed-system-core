import{d as B,r as n,f as F,n as _,q as v,k as L,o as p,l as R,h as V,a,w as C,b as j,v as q,c as M,j as G,t as x,F as P,g as X}from"./app-DuMmWb0e.js";import{_ as Y}from"./AdminLayout-CuGKItQZ.js";import{D as z}from"./DeleteModel-Bb8bUFVd.js";import{$ as i}from"./dataTables.bootstrap4.min-Db9EHKM2.js";import"./AdminFooter-i6V7ulTS.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                                    */const H={class:"row mb-2"},U={class:"col-sm-6"},J={class:"breadcrumb float-sm-right mt-2"},K={class:"breadcrumb-item"},Q=["href"],W={class:"row"},Z={class:"col-12"},ee={class:"card"},ae={class:"card-body"},te={class:"row"},se={class:"col-lg-6"},le={class:"form-group"},oe={class:"row"},re={class:"col-12"},ie={class:"card card-secondary"},ne={class:"card-body"},ce={id:"categoryTable",class:"table table-hover"},de=["onClick"],ue=["onClick"],De={__name:"CategoryManagement",setup(me){const o=B(),b=n(!1),h=n(null),c=n({name:""}),g=n(null),f=n(!1),w=n(""),y=n(null),d=n([]);function k(s,e){y.value=s,w.value=e,f.value=!0}function E(){y.value&&(S(y.value),f.value=!1)}const S=s=>{v.delete(`/categories/${s}`).then(e=>{var t,l;(t=e==null?void 0:e.data)!=null&&t.message?(o.warning(e.data.message),d.value=d.value.filter(r=>r.id!==s),i.fn.DataTable.isDataTable("#categoryTable")&&i("#categoryTable").DataTable().destroy(),_(()=>{u()})):(l=e==null?void 0:e.data)!=null&&l.error&&o.error(e.data.error)}).catch(e=>{var t,l,r,m;(l=(t=e.response)==null?void 0:t.data)!=null&&l.errors?Object.values(e.response.data.errors||{}).flat().forEach(D=>{o.error(D)}):(m=(r=e.response)==null?void 0:r.data)!=null&&m.message?o.error(e.response.data.message):o.error("An unexpected error occurred."),console.error(e)})},N=s=>{c.value.name=s.name,h.value=s.id,b.value=!0},O=s=>{if(s.preventDefault(),!g.value.checkValidity()){g.value.classList.add("was-validated");return}b.value?v.put(`/categories/${h.value}`,c.value).then(e=>{var t,l;(t=e==null?void 0:e.data)!=null&&t.message?(o.success(e.data.message),$(),A()):(l=e==null?void 0:e.data)!=null&&l.error&&o.error(e.data.error)}).catch(handleError):v.post("/categories",c.value).then(e=>{var t,l;(t=e==null?void 0:e.data)!=null&&t.message?(o.success(e.data.message),c.value.name="",i.fn.DataTable.isDataTable("#categoryTable")&&(i("#categoryTable").DataTable().destroy(),T().then(()=>{u()}))):(l=e==null?void 0:e.data)!=null&&l.error&&o.error(e.data.error)}).catch(e=>{var t,l,r,m;(l=(t=e.response)==null?void 0:t.data)!=null&&l.errors?Object.values(e.response.data.errors||{}).flat().forEach(D=>{o.error(D)}):(m=(r=e.response)==null?void 0:r.data)!=null&&m.message?o.error(e.response.data.message):o.error("An unexpected error occurred."),console.error(e)})},$=()=>{c.value.name="",b.value=!1,h.value=null,g.value.classList.remove("was-validated")},A=()=>{i.fn.DataTable.isDataTable("#categoryTable")&&(i("#categoryTable").DataTable().destroy(),T().then(()=>{u()}))};F(()=>{T().then(()=>{u()}),_(()=>{const s=localStorage.getItem("successMessage");s&&(o.success(s),localStorage.removeItem("successMessage"))})});const T=async()=>{try{const s=await v.get("/categories");d.value=s.data}catch(s){console.error("Error fetching courses:",s)}};function u(){_(()=>{i.fn.DataTable.isDataTable("#categoryTable")&&i("#categoryTable").DataTable().destroy(),i("#categoryTable").DataTable({responsive:!0,scrollX:!0,scrollX:"200px",scrollCollapse:!1,paging:!0});const s=localStorage.getItem("successMessage");s&&(o.success(s),localStorage.removeItem("successMessage"))})}return L(d,()=>{u()}),(s,e)=>(p(),R(Y,null,{default:V(()=>[a("div",H,[e[3]||(e[3]=a("div",{class:"col-sm-6"},[a("h4",{class:"mt-2"},"CATEGORY")],-1)),a("div",U,[a("ol",J,[a("li",K,[a("a",{href:s.route("admin.dashboard")},"Home",8,Q)]),e[2]||(e[2]=a("li",{class:"breadcrumb-item active"},"Category",-1))])])]),a("div",W,[a("div",Z,[a("div",ee,[e[7]||(e[7]=a("div",{class:"card-header"},[a("h6",{class:"card-title",style:{"font-weight":"700"}},"Create New Category"),a("div",{class:"card-tools"},[a("button",{type:"button",class:"btn btn-tool","data-card-widget":"collapse"},[a("i",{class:"fas fa-minus"})]),a("button",{type:"button",class:"btn btn-tool","data-card-widget":"remove"},[a("i",{class:"fas fa-times"})])])],-1)),a("div",ae,[a("form",{class:"needs-validation",ref_key:"formRef",ref:g,onSubmit:C(O,["prevent"]),novalidate:""},[a("div",te,[a("div",se,[a("div",le,[e[4]||(e[4]=a("label",{for:"category-name"},"Category Name :",-1)),j(a("input",{type:"text",class:"form-control",id:"name",placeholder:"Enter Category Name","onUpdate:modelValue":e[0]||(e[0]=t=>c.value.name=t),required:""},null,512),[[q,c.value.name]]),e[5]||(e[5]=a("div",{class:"invalid-feedback"}," Please Provide Enter Category Name ",-1))])]),e[6]||(e[6]=a("div",{class:"col-lg-6"},[a("label",{for:"category-name"}),a("button",{type:"submit ",class:"btn btn-primary category-btn",style:{"margin-top":"32px"}},"Save")],-1))])],544)])])])]),a("div",oe,[a("div",re,[a("div",ie,[a("div",ne,[e[11]||(e[11]=a("h6",{style:{"font-weight":"700"},class:""},"CATEGORY TABLE",-1)),e[12]||(e[12]=a("hr",null,null,-1)),a("table",ce,[e[10]||(e[10]=a("thead",null,[a("tr",null,[a("th",{width:"100px"},"ID"),a("th",{width:"85%"},"Category Name"),a("th",{width:"20%"},"Action")])],-1)),a("tbody",null,[(p(!0),M(P,null,G(d.value,(t,l)=>(p(),M("tr",{key:t.id},[a("td",null,x(1+l),1),a("td",null,x(t.name),1),a("td",null,[a("a",{href:"#",onClick:C(r=>N(t),["prevent"])},e[8]||(e[8]=[a("img",{src:"/images/icon/edit.png",alt:"",width:"25px",height:"25px",class:"mr-2 table-action-icon"},null,-1)]),8,de),a("a",{onClick:r=>k(t.id,"Delete Category"),style:{cursor:"pointer"}},e[9]||(e[9]=[a("img",{src:"/images/icon/trash-bin.png",alt:"",width:"25px",height:"25px",class:"table-action-icon"},null,-1)]),8,ue)])]))),128))])])])])])]),X(z,{isModalOpen:f.value,modalTitle:w.value,onClose:e[1]||(e[1]=t=>f.value=!1),onConfirmDelete:E},null,8,["isModalOpen","modalTitle"])]),_:1}))}};export{De as default};
